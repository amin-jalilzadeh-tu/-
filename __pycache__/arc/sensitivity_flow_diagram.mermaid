graph TB
    Start([Start Sensitivity Analysis]) --> CheckConfig{Check Configuration}
    
    CheckConfig -->|Basic Config| ValidatePaths[Patch Relative Paths]
    CheckConfig -->|Advanced Enabled| ValidateAdvanced[Validate Advanced Config]
    
    ValidatePaths --> CheckPrereq{Check Prerequisites}
    ValidateAdvanced --> CheckPrereq
    
    CheckPrereq -->|Traditional| CheckTrad[Check Parsed Data]
    CheckPrereq -->|Modification| CheckMod[Check Modified IDFs]
    CheckPrereq -->|Scenario| CheckScen[Check Scenarios]
    
    CheckTrad --> InitManager[Initialize Sensitivity Manager]
    CheckMod --> InitManager
    CheckScen --> InitManager
    
    InitManager --> RunBase[Run Base Analysis]
    
    RunBase -->|Traditional| TradAnalysis[Traditional Sensitivity]
    RunBase -->|Modification| ModAnalysis[Modification-based]
    
    TradAnalysis --> CheckAdvanced{Advanced Analysis<br/>Enabled?}
    ModAnalysis --> CheckAdvanced
    
    CheckAdvanced -->|No| GenerateReport
    CheckAdvanced -->|Yes| PrepareData[Prepare X, y Data]
    
    PrepareData --> RunAdvanced{Run Advanced Methods}
    
    RunAdvanced --> Uncertainty[Uncertainty<br/>Quantification]
    RunAdvanced --> Threshold[Threshold<br/>Detection]
    RunAdvanced --> Regional[Regional<br/>Sensitivity]
    RunAdvanced --> Sobol[Sobol<br/>Decomposition]
    RunAdvanced --> Temporal[Temporal<br/>Patterns]
    
    Uncertainty --> Consolidate[Consolidate Results]
    Threshold --> Consolidate
    Regional --> Consolidate
    Sobol --> Consolidate
    Temporal --> Consolidate
    
    Consolidate --> GenerateReport[Generate Reports]
    
    GenerateReport --> SaveFiles{Save Output Files}
    
    SaveFiles --> BaseResults[sensitivity_results.parquet]
    SaveFiles --> UncertaintyFile[uncertainty_analysis_results.parquet]
    SaveFiles --> ThresholdFile[threshold_analysis_results.parquet]
    SaveFiles --> RegionalFile[regional_sensitivity_results.parquet]
    SaveFiles --> SobolFile[sobol_analysis_results.parquet]
    SaveFiles --> TemporalFile[temporal_pattern_results.parquet]
    SaveFiles --> Report[sensitivity_report.html]
    SaveFiles --> AdvancedReport[advanced_sensitivity_report.json]
    
    BaseResults --> LogSummary[Log Results Summary]
    Report --> LogSummary
    AdvancedReport --> LogSummary
    
    LogSummary --> End([Analysis Complete])
    
    style Start fill:#e1f5e1
    style End fill:#e1f5e1
    style Uncertainty fill:#e3f2fd
    style Threshold fill:#fce4ec
    style Regional fill:#fff3e0
    style Sobol fill:#f3e5f5
    style Temporal fill:#e8f5e9
    style CheckAdvanced fill:#fff9c4